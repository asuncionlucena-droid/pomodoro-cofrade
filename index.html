<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Pomodoro Cofrade</title>

<style>
body{
margin:0;
background:#000;
color:#fff;
font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto;
}
.wrap{max-width:1000px;margin:auto;padding:25px;}
.card{background:#0b0b0b;border:1px solid #222;border-radius:18px;padding:20px;margin-bottom:20px;}
.time{font-size:70px;text-align:center;margin:20px 0;}
button{background:#111;color:#fff;border:1px solid #444;padding:12px;border-radius:12px;margin:6px;cursor:pointer;}
input{background:#000;border:1px solid #333;color:#fff;padding:8px;border-radius:8px;width:100%;}
.tag{padding:6px 12px;border:1px solid #444;border-radius:999px;display:inline-block;margin-top:10px;}
</style>
</head>

<body>
<div class="wrap">

<div class="card">
<h2>Pomodoro Cofrade</h2>

<div id="countdown"></div>
<div>Hermandad actual: <span id="hermandadActual" class="tag"></span></div>

<div class="time" id="time">30:00</div>

<button onclick="start()">Empezar</button>
<button onclick="pause()">Pausar</button>
<button onclick="reset()">Reiniciar</button>
<button onclick="abrirSpotify()">Spotify</button>

<div style="margin-top:15px">
Foco (min): <input id="focusMin" type="number" value="30">
Descanso (min): <input id="breakMin" type="number" value="5">
</div>

<div style="margin-top:15px">
Enlace Spotify:
<input id="spotifyUrl" placeholder="pega tu playlist aquí">
</div>

<div style="margin-top:20px">
Tramos: <span id="tramos">0</span><br>
Hermandades: <span id="hermandades">0</span>
</div>

</div>

</div>

<script>

let mode="focus";
let timer=null;
let remaining=1800;
let tramos=0;

const hermandades=[
"La Borriquita","Jesús Despojado","La Paz","La Cena","San Roque","La Hiniesta","El Amor",
"San Pablo","La Redención","Santa Genoveva","Santa Marta","San Gonzalo","Vera-Cruz","Las Penas","Las Aguas","El Museo",
"El Cerro","San Benito","Dulce Nombre","La Candelaria","San Esteban","Los Javieres","Los Estudiantes",
"La Sed","San Bernardo","El Buen Fin","La Lanzada","El Baratillo","Las Siete Palabras","Cristo de Burgos",
"Los Negritos","La Exaltación","Las Cigarreras","Montesión","La Quinta Angustia","El Valle","Pasión",
"El Silencio","Gran Poder","Macarena","Calvario","Esperanza de Triana","Los Gitanos",
"La Carretería","Soledad San Buenaventura","El Cachorro","La O","San Isidoro","Montserrat","La Mortaja",
"El Sol","Servitas","La Trinidad","Santo Entierro","Soledad San Lorenzo",
"La Resurrección"
];

function format(s){let m=Math.floor(s/60);let sec=s%60;return m+":"+sec.toString().padStart(2,"0");}

function sonido(){
const ctx=new AudioContext();
const osc=ctx.createOscillator();
osc.frequency.value=500;
osc.connect(ctx.destination);
osc.start();
setTimeout(()=>osc.stop(),200);
}

function start(){
let focus=document.getElementById("focusMin").value*60;
let breakt=document.getElementById("breakMin").value*60;
if(mode=="focus")remaining=focus;
timer=setInterval(()=>{
remaining--;
if(remaining<=0){
sonido();
if(mode=="focus"){tramos++;mode="break";remaining=breakt;}
else{mode="focus";remaining=focus;}
}
render();
},1000);
}

function pause(){clearInterval(timer);}

function reset(){pause();remaining=1800;render();}

function abrirSpotify(){
let url=document.getElementById("spotifyUrl").value;
window.open(url);
}

function render(){
document.getElementById("time").innerText=format(remaining);
document.getElementById("tramos").innerText=tramos;
document.getElementById("hermandades").innerText=Math.floor(tramos/4);
document.getElementById("hermandadActual").innerText=hermandades[Math.floor(tramos/4)%hermandades.length];
}

render();

</script>

</body>
</html>
